{"version":3,"sources":["../../../app-src/domain/negociacao/NegociacaoDao.js"],"names":["NegociacaoDao","constructor","connection","_connection","_store","adiciona","negociacao","Promise","resolve","reject","request","transaction","objectStore","add","onsuccess","e","onerror","listaTodos","negociacoes","cursor","openCursor","atual","target","result","Negociacao","value","_data","_quantidade","_valor","push","continue","console","log","error","apagaTodos","clear"],"mappings":";;;;;;AACO,kBAAMA,aAAN,CAAoB;AACvBC,4BAAYC,UAAZ,EAAwB;AACpB,yBAAKC,WAAL,GAAmBD,UAAnB;AACA,yBAAKE,MAAL,GAAc,aAAd;AACH;;AAEDC,yBAASC,UAAT,EAAqB;AACjB,2BAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,8BAAMC,UAAU,KAAKP,WAAL,CACXQ,WADW,CACC,CAAC,KAAKP,MAAN,CADD,EACgB,WADhB,EAEXQ,WAFW,CAEC,KAAKR,MAFN,EAGXS,GAHW,CAGPP,UAHO,CAAhB;;AAKAI,gCAAQI,SAAR,GAAoBC,KAAKP,SAAzB;;AAEAE,gCAAQM,OAAR,GAAkBD,KAAKN,OAAO,sCAAP,CAAvB;AACH,qBATM,CAAP;AAUH;;AAEDQ,6BAAa;AACT,2BAAO,IAAIV,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,8BAAMS,cAAc,EAApB;AACA,8BAAMC,SAAS,KAAKhB,WAAL,CACVQ,WADU,CACE,CAAC,KAAKP,MAAN,CADF,EACiB,WADjB,EAEVQ,WAFU,CAEE,KAAKR,MAFP,EAGVgB,UAHU,EAAf;;AAMAD,+BAAOL,SAAP,GAAmBC,KAAK;AACpB,kCAAMM,QAAQN,EAAEO,MAAF,CAASC,MAAvB;AACA,gCAAIF,KAAJ,EAAW;AACP,sCAAMf,aAAa,IAAIkB,UAAJ,CACfH,MAAMI,KAAN,CAAYC,KADG,EAEfL,MAAMI,KAAN,CAAYE,WAFG,EAGfN,MAAMI,KAAN,CAAYG,MAHG,CAAnB;AAIAV,4CAAYW,IAAZ,CAAiBvB,UAAjB;AACAe,sCAAMS,QAAN;AACH,6BAPD,MAOO;AACH;AACAtB,wCAAQU,WAAR;AACH;AACJ,yBAbD;AAcAC,+BAAOH,OAAP,GAAiBD,KAAK;AAClBgB,oCAAQC,GAAR,CAAYjB,EAAEO,MAAF,CAASW,KAArB;AACAxB,mCAAO,yCAAP;AACH,yBAHD;AAIH,qBA1BM,CAAP;AA2BH;;AAEDyB,6BAAa;AACT,2BAAO,IAAI3B,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACpC,8BAAMC,UAAU,KAAKP,WAAL,CACXQ,WADW,CACC,CAAC,KAAKP,MAAN,CADD,EACgB,WADhB,EAEXQ,WAFW,CAEC,KAAKR,MAFN,EAGX+B,KAHW,EAAhB;AAIAzB,gCAAQI,SAAR,GAAoBC,KAAKP,SAAzB;AACAE,gCAAQM,OAAR,GAAkBD,KAAK;AACnBgB,oCAAQC,GAAR,CAAYjB,EAAEO,MAAF,CAASW,KAArB;AACAxB,mCAAO,wCAAP;AACH,yBAHD;AAIH,qBAVM,CAAP;AAWH;AA7DsB","file":"NegociacaoDao.js","sourcesContent":["\nexport class NegociacaoDao {\n    constructor(connection) {\n        this._connection = connection;\n        this._store = 'negociacoes';\n    }\n\n    adiciona(negociacao) {\n        return new Promise((resolve, reject) => {\n            const request = this._connection\n                .transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .add(negociacao);\n\n            request.onsuccess = e => resolve();\n\n            request.onerror = e => reject('Não foi possível salvar a negociação');\n        });\n    }\n\n    listaTodos() {\n        return new Promise((resolve, reject) => {\n            const negociacoes = [];\n            const cursor = this._connection\n                .transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .openCursor();\n\n\n            cursor.onsuccess = e => {\n                const atual = e.target.result;\n                if (atual) {\n                    const negociacao = new Negociacao(\n                        atual.value._data,\n                        atual.value._quantidade,\n                        atual.value._valor);\n                    negociacoes.push(negociacao);\n                    atual.continue();\n                } else {\n                    // resolvendo a promise com negociacoes\n                    resolve(negociacoes);\n                }\n            };\n            cursor.onerror = e => {\n                console.log(e.target.error);\n                reject('Não foi possível listar nas negociações');\n            }\n        });\n    }\n\n    apagaTodos() {\n        return new Promise((resolve, reject) => {\n            const request = this._connection\n                .transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .clear();\n            request.onsuccess = e => resolve();\n            request.onerror = e => {\n                console.log(e.target.error);\n                reject('Não foi possível apagar as negociações');\n            };\n        });\n    }\n}"]}