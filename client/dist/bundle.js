(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};return a[d].call(e.exports,e,e.exports,b),e.l=!0,e.exports}var c={};return b.m=a,b.c=c,b.d=function(a,c,d){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:d})},b.n=function(a){var c=a&&a.__esModule?function(){return a['default']}:function(){return a};return b.d(c,'a',c),c},b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)},b.p='dist',b(b.s=7)})([function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{constructor(a,b,c){Object.assign(this,{_data:new Date(a.getTime()),_quantidade:b,_valor:c}),Object.freeze(this)}get data(){return new Date(this._data.getTime())}get quantidade(){return this._quantidade}get valor(){return this._valor}get volume(){return this._quantidade*this._valor}}},function(a,b,c){'use strict';c.d(b,'a',function(){return e});var d=c(0);let e=class{constructor(a){this._connection=a,this._store='negociacoes'}adiciona(a){return new Promise((b,c)=>{const d=this._connection.transaction([this._store],'readwrite').objectStore(this._store).add(a);d.onsuccess=()=>b(),d.onerror=()=>c('N\xE3o foi poss\xEDvel salvar a negocia\xE7\xE3o')})}listaTodos(){return new Promise((a,b)=>{const c=[],e=this._connection.transaction([this._store],'readwrite').objectStore(this._store).openCursor();e.onsuccess=(b)=>{const e=b.target.result;if(e){const a=new d.a(e.value._data,e.value._quantidade,e.value._valor);c.push(a),e.continue()}else a(c)},e.onerror=(a)=>{console.log(a.target.error),b('N\xE3o foi poss\xEDvel listar nas negocia\xE7\xF5es')}})}apagaTodos(){return new Promise((a,b)=>{const c=this._connection.transaction([this._store],'readwrite').objectStore(this._store).clear();c.onsuccess=()=>a(),c.onerror=(a)=>{console.log(a.target.error),b('N\xE3o foi poss\xEDvel apagar as negocia\xE7\xF5es')}})}}},function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{_handleErrors(a){if(!a.ok)throw new Error(a.statusText);return a}get(a){return fetch(a).then((a)=>this._handleErrors(a)).then((a)=>a.json())}}},function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{constructor(){throw new Error('Esta classe n\xE3o pode ser instanciada')}static paraTexto(a){return a.toLocaleDateString()}static paraData(a){if(console.log('texto',a),!/^\d{4}-\d{2}-\d{2}/.test(a))throw new Error('A data nao egue o padr\xE3o correto');return new Date(...a.split('-').map((a,b)=>a-b%2))}}},function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{constructor(a){this._elemento=document.querySelector(a)}update(a){this._elemento.innerHTML=this.template(a)}template(){throw new Error('Voc\xEA precisa implementar o m\xE9todo template')}}},function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{static create(a,b,c){return new Proxy(a,{get(a,d){return typeof a[d]==typeof Function&&b.includes(d)?function(){a[d].apply(a,arguments),c(a)}:a[d]},set(a,d,e){const f=Reflect.set(a,d,e);return b.includes(d)&&c(a),f}})}}},function(a,b){'use strict';const c=(()=>{const a=['negociacoes'];let b=null,c=null;return class d{constructor(){throw new Error('Static Class, n\xE3o \xE9 poss\xEDvel criar uma inst\xE2ncia da mesma')}static getConnection(){return new Promise((a,f)=>{if(b)return a(b);const e=indexedDB.open('jscangaceiro',2);e.onupgradeneeded=(a)=>{d._createStores(a.target.result)},e.onsuccess=(d)=>{b=d.target.result,c=b.close.bind(b),b.close=()=>{throw new Error('Voc\xEA n\xE3o pode fechar diretamente a conex\xE3o')},a(b)},e.onerror=(a)=>f(a.target.error.name)})}static closeConnection(){b&&c()}static _createStores(b){a.forEach((a)=>{b.objectStoreNames.contains(a)&&b.deleteObjectStore(a),b.createObjectStore(a,{autoIncrement:!0})})}}})();b.a=c},function(a,b,c){'use strict';Object.defineProperty(b,'__esModule',{value:!0});var d=c(8),e=c.n(d),f=c(9),g=c.n(f),h=c(10),i=c.n(h),j=c(11);const k=document.querySelector.bind(document);let l=new j.a;k('.form').addEventListener('submit',l.adiciona.bind(l)),k('#botao-apaga').addEventListener('click',l.apaga.bind(l)),k('#botao-importa').addEventListener('click',l.importaNegociacoes.bind(l))},function(){},function(){},function(){},function(a,b,c){'use strict';function d(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}function e(a,b,c,d,e){var f={};return Object.keys(d).forEach(function(a){f[a]=d[a]}),f.enumerable=!!f.enumerable,f.configurable=!!f.configurable,('value'in f||f.initializer)&&(f.writable=!0),f=c.slice().reverse().reduce(function(c,d){return d(a,b,c)||c},f),e&&void 0!==f.initializer&&(f.value=f.initializer?f.initializer.call(e):void 0,f.initializer=void 0),void 0===f.initializer&&(Object.defineProperty(a,b,f),f=null),f}c.d(b,'a',function(){return n});var f,g,h,i,j,k=c(12),l=c(15),m=c(20);let n=(f=m.b('#data','#quantidade','#valor'),g=m.c(),h=m.c(1500),f(i=(j=class{constructor(a,b,c){document.querySelector.bind(document);this._inputData=a,this._inputQuantidade=b,this._inputValor=c,this._negociacoes=new m.a(new k.c(),new l.d('#negociacoes'),'adiciona','esvazia'),this._mensagem=new m.a(new l.b(),new l.c('#mensagemView'),'texto'),this._service=new k.b,this._init()}_init(){var a=this;return d(function*(){try{const b=yield m.d(),c=yield b.listaTodos();c.forEach(function(b){return a._negociacoes.adiciona(b)})}catch(b){a._mensagem.texto=b}})()}adiciona(a){var b=this;return d(function*(){try{a.preventDefault();const c=b.criarNegociacao(b._inputData,b._inputQuantidade,b._inputValor),d=yield m.d();yield d.adiciona(c),b._negociacoes.adiciona(c),b._mensagem.texto='Negocia\xE7\xE3o adiconada com Sucesso!!!',b.limpaFormulario()}catch(a){console.log('err',a),b._mensagem.texto=a}})()}esvazia(){this._negociacoes.esvazia()}criarNegociacao(a,b,c){return new k.a(new Date(l.a.paraData(a.value)),parseInt(b.value),parseFloat(c.value))}importaNegociacoes(){var a=this;return d(function*(){try{const b=yield a._service.obterNegociacoesDoPerildo();b.forEach(function(b){return a._negociacoes.adiciona(b)}),a._mensagem.texto='Negocia\xE7\xF5es importadas com sucesso'}catch(b){a._mensagem.texto=b}})()}apaga(){var a=this;return d(function*(){try{const b=yield m.d();yield b.apagaTodos(),a._negociacoes.esvazia(),a._mensagem.texto='Negocia\xE7\xF5es apagadas com sucesso'}catch(b){a._mensagem.texto=b}})()}limpaFormulario(){this._inputData.value='',this._inputQuantidade.value=1,this._inputValor.value=0}},e(j.prototype,'adiciona',[g],Object.getOwnPropertyDescriptor(j.prototype,'adiciona'),j.prototype),e(j.prototype,'importaNegociacoes',[h],Object.getOwnPropertyDescriptor(j.prototype,'importaNegociacoes'),j.prototype),j))||i)},function(a,b,c){'use strict';var d=c(0);c.d(b,'a',function(){return d.a});var e=c(1),f=c(13);c.d(b,'b',function(){return f.a});var g=c(14);c.d(b,'c',function(){return g.a})},function(a,b,c){'use strict';function d(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}c.d(b,'a',function(){return g});var e=c(2),f=c(0);let g=class{constructor(){this.http=new e.a}obterNegociacoesDaSemana(){return new e.a().get('http://localhost:3000/negociacoes/semana').then((a)=>a.map((a)=>new f.a(new Date(a.data),a.quantidade,a.valor))).catch(()=>{throw new Error('N\xE3o foi poss\xEDvel obter as negocia\xE7\xF5es')})}obterNegociacoesDaSemanaAnterior(){return new e.a().get('http://localhost:3000/negociacoes/anterior').then((a)=>a.map((a)=>new f.a(new Date(a.data),a.quantidade,a.valor))).catch(()=>{throw new Error('N\xE3o foi poss\xEDvel obter as negocia\xE7\xF5es da semana anterior')})}obterNegociacoesDaSemanaRetrasada(){return new e.a().get('http://localhost:3000/negociacoes/retrasada').then((a)=>a.map((a)=>new f.a(new Date(a.data),a.quantidade,a.valor))).catch(()=>{throw new Error('N\xE3o foi poss\xEDvel obter as negocia\xE7\xF5es da semana retrasada')})}obterNegociacoesDoPerildo(){var a=this;return d(function*(){try{const b=yield Promise.all([a.obterNegociacoesDaSemana(),a.obterNegociacoesDaSemanaAnterior(),a.obterNegociacoesDaSemanaRetrasada()]);return b.reduce(function(b,c){return[...b,...c]},[]).sort(function(c,a){return c.data.getTime()-a.data.getTime()})}catch(a){throw console.log(err),new Error('N\xE3o foi poss\xEDvel obter as negocia\xE7\xF5es do per\xEDodo')}})()}}},function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{constructor(){this._negociacoes=[]}get volumeTotal(){return this._negociacoes.reduce((a,b)=>a+b.volume,0)}adiciona(a){this._negociacoes=[...this._negociacoes,a]}esvazia(){this._negociacoes.length=0}paraArray(){return this._negociacoes.map((a)=>a)}}},function(a,b,c){'use strict';var d=c(3);c.d(b,'a',function(){return d.a});var e=c(16);c.d(b,'b',function(){return e.a});var f=c(17);c.d(b,'c',function(){return f.a}),c.d(b,'d',function(){return f.b})},function(a,b,c){'use strict';c.d(b,'a',function(){return d});let d=class{constructor(a=''){this._texto=a}get texto(){return this._texto}set texto(a){this._texto=a}}},function(a,b,c){'use strict';var d=c(18);c.d(b,'a',function(){return d.a});var e=c(19);c.d(b,'b',function(){return e.a})},function(a,b,c){'use strict';c.d(b,'a',function(){return e});var d=c(4);let e=class extends d.a{template(a){return a.texto?`<p class="alert alert-info">${a.texto}</p>`:`<p></p>`}}},function(a,b,c){'use strict';c.d(b,'a',function(){return f});var d=c(4),e=c(3);let f=class extends d.a{template(a){return`
            <table class="table table-hover table-bordered">
                <thead>
                    <tr>
                        <th>DATA</th>
                        <th>QUANTIDADE</th>
                        <th>VALOR</th>
                        <th>VOLUME</th>
                    </tr>
                </thead>
                <tbody>
                    ${a.paraArray().map((a)=>{return`
                            <tr>
                                <td>${e.a.paraTexto(a.data)}</td>
                                <td>${a.quantidade}</td>
                                <td>${a.valor}</td>
                                <td>${a.volume}</td>
                            </tr>
                    `}).join('')}
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3"></td>
                        <td>${a.volumeTotal}</td>
                        </tr>
                </tfoot>
            </table>
        `}}},function(a,b,c){'use strict';var d=c(21);c.d(b,'b',function(){return d.a});var e=c(22);c.d(b,'c',function(){return e.a});var f=c(23);c.d(b,'a',function(){return f.a});var g=c(6),h=c(24);c.d(b,'d',function(){return h.a});var i=c(2),j=c(5)},function(a,b){'use strict';b.a=function(...a){const b=a.map((a)=>document.querySelector(a));return function(a){const c=a,d=function(){return new c(...b)};return d.prototype=c.prototype,d}}},function(a,b){'use strict';b.a=function(a=500){return function(b,c,d){const e=d.value;let f=0;return d.value=function(...b){event&&event.preventDefault(),clearTimeout(f),f=setTimeout(()=>{e.apply(this,b)},a)},d}}},function(a,b,c){'use strict';c.d(b,'a',function(){return e});var d=c(5);let e=class{constructor(a,b,...c){const e=d.a.create(a,c,(a)=>b.update(a));return b.update(a),e}}},function(a,b,c){'use strict';var d=c(6),e=c(1);b.a=()=>d.a.getConnection().then((a)=>new e.a(a))}]);